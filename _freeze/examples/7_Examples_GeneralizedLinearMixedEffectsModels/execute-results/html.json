{
  "hash": "d5d374d7c470354073e52e9420ce563e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Generalized Linear Mixed Effects Models\"\nauthor: \"Biostatistics Working Group\"\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n## Overview\nGeneralized Linear Mixed Models (GLMMs) extend generalized linear models to include both fixed and random effects, allowing for the analysis of non-normal response variables and accounting for the correlation within clustered or repeated measures data. GLMMs are particularly useful when dealing with hierarchical data structures, offering a flexible framework to model various types of response distributions.\n\nThis example will examine height across 3 annual measurement occasions in a sample of youth taking part in the ABCD Study. The primary aim is to characterize the growth pattern in height over time, while accounting for the repeated measures within individuals. GLMMs will be used to estimate both the overall population effects (fixed effects) and individual-specific deviations (random effects) from the population mean, providing a detailed understanding of height changes over time with the ability to model different types of response distributions.\n\n## Preliminary Setup\n### Load R libraries\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)    # Collection of R packages for data science\nlibrary(rstatix)      # Pipe-friendly framework for basic statistical tests\nlibrary(lme4)         # Linear mixed-effects models\nlibrary(gtsummary) # Publication-ready tables\n```\n:::\n\n\n### Descriptives\n\n::: {.cell}\n\n```{.r .cell-code}\ndescriptives_table <- df_long %>%\n    select(event, handedness) %>%\n    mutate(event = factor(event)) %>%\n    tbl_summary(\n        by = event,\n        missing = \"no\",\n        label = list(handedness ~ \"Handedness\"),\n        statistic = list(all_continuous() ~ \"{mean} ({sd})\", all_categorical() ~ \"{p}%\"),\n    ) %>%\n    modify_header(all_stat_cols() ~ \"**{level}**<br>N = {n}\") %>%\n    bold_labels() %>%\n    italicize_levels() %>%\n    modify_spanning_header(all_stat_cols() ~ \"**Assessment Wave**\")\ntheme_gtsummary_compact()\n\ndescriptives_table\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"uzejttswbl\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#uzejttswbl table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#uzejttswbl thead, #uzejttswbl tbody, #uzejttswbl tfoot, #uzejttswbl tr, #uzejttswbl td, #uzejttswbl th {\n  border-style: none;\n}\n\n#uzejttswbl p {\n  margin: 0;\n  padding: 0;\n}\n\n#uzejttswbl .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 13px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#uzejttswbl .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#uzejttswbl .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#uzejttswbl .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#uzejttswbl .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#uzejttswbl .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uzejttswbl .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#uzejttswbl .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#uzejttswbl .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#uzejttswbl .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#uzejttswbl .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#uzejttswbl .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#uzejttswbl .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#uzejttswbl .gt_group_heading {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#uzejttswbl .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#uzejttswbl .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#uzejttswbl .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#uzejttswbl .gt_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#uzejttswbl .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uzejttswbl .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#uzejttswbl .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#uzejttswbl .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#uzejttswbl .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uzejttswbl .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#uzejttswbl .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#uzejttswbl .gt_last_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uzejttswbl .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uzejttswbl .gt_first_grand_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#uzejttswbl .gt_last_grand_summary_row_top {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uzejttswbl .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#uzejttswbl .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uzejttswbl .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#uzejttswbl .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uzejttswbl .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#uzejttswbl .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uzejttswbl .gt_left {\n  text-align: left;\n}\n\n#uzejttswbl .gt_center {\n  text-align: center;\n}\n\n#uzejttswbl .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#uzejttswbl .gt_font_normal {\n  font-weight: normal;\n}\n\n#uzejttswbl .gt_font_bold {\n  font-weight: bold;\n}\n\n#uzejttswbl .gt_font_italic {\n  font-style: italic;\n}\n\n#uzejttswbl .gt_super {\n  font-size: 65%;\n}\n\n#uzejttswbl .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#uzejttswbl .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#uzejttswbl .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#uzejttswbl .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#uzejttswbl .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#uzejttswbl .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#uzejttswbl .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"4\" scope=\"colgroup\" id=\"&lt;strong&gt;Assessment Wave&lt;/strong&gt;\">\n        <span class=\"gt_column_spanner\"><strong>Assessment Wave</strong></span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Baseline&lt;/strong&gt;&lt;br&gt;N = 9965&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Baseline</strong><br>N = 9965<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Year_1&lt;/strong&gt;&lt;br&gt;N = 9965&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Year_1</strong><br>N = 9965<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Year_2&lt;/strong&gt;&lt;br&gt;N = 9965&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Year_2</strong><br>N = 9965<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Year_3&lt;/strong&gt;&lt;br&gt;N = 9965&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Year_3</strong><br>N = 9965<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">Handedness</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-style: italic;\">    1</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">79%</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">NA%</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">NA%</td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\">NA%</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-style: italic;\">    2</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">21%</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">NA%</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">NA%</td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\">NA%</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> %</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n## Results\n### Compute Generalized Linear Mixed Models\nThis code fits a Generalized Linear Mixed Model (GLMM) to predict 'Height' across 3 annual visits, incorporating both fixed effects for overall population trends and random effects to account for individual-level variability. The model output is provided below, along with a summary of results. This model accounts for the hierarchical structure of the data, with random intercepts capturing individual deviations from the population mean height trajectory.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# # Fit the GLMM model\n# model <- lmer(handedness ~ 1 + event + (1 | id), data = df_long, REML = TRUE)\n# \n# # Extract fixed effects\n# fixed_effects <- fixef(model)\n# \n# summary(model)\n# summary(fixed_effects)\n```\n:::\n\n\nThese results show an increasing trajectory of height across the years, with an increase of approximately 2.42 inches in Year 1 and 4.93 inches by Year 2 compared to the baseline, as evidenced by the fixed effects estimates. The random intercepts effect suggests some between-subject variability in participants' height values at baseline, with a standard deviation of about 3.08 inches. The model's residuals are mostly well-behaved, although the range suggests a few extreme values or outliers.\n\n### Model Plots\n\n::: {.cell}\n\n```{.r .cell-code}\n# # Prepare data frame for plotting\n# df_long$predicted_height <- predict(model, re.form = NA) # Overall fixed effect predictions\n# \n# # Calculate individual intercept adjustments\n# df_long$individual_intercept <- predict(model, re.form = ~ (1 | id)) - fixed_effects[1]\n# \n# # Combine fixed effects and random effects predictions\n# df_long$combined_predicted_height <- df_long$predicted_height + df_long$individual_intercept\n# \n# # Generate the plot\n# ggplot(df_long, aes(x = event, y = height)) +\n#   geom_point(alpha = 0.3) +\n#   geom_line(aes(y = combined_predicted_height, group = id), color = \"grey\", alpha = 0.5) +\n#   geom_line(aes(y = predicted_height, group = 1), color = \"blue\", size = 1.5) +\n#   labs(\n#     title = \"Predicted vs. Observed Heights with GLMM\",\n#     x = \"Event\",\n#     y = \"Height (inches)\"\n#   ) +\n#   theme_minimal()\n```\n:::\n\n\nThis plot illustrates the predicted versus observed heights across three annual measurement occasions, as estimated by the Generalized Linear Mixed Model (GLMM). The scatter plot shows actual height measurements for each individual, highlighting variability among participants. The grey lines represent individual predicted heights, accounting for both fixed effects and random intercepts, while the blue line shows the population-level trend.\n\nThe plot reveals a clear increasing trend in height over time, with predicted height values rising at each measurement occasion. The grey lines indicate substantial individual variability, whereas the blue line captures the overall trend. This visualization effectively highlights both the population-averaged growth pattern and individual differences in height changes over time, demonstrating the GLMM's ability to model these dynamics.\n\n## Wrapping Up\nThe marginal model analysis using Generalized Linear Mixed Effects Models (GLMM) revealed a significant increasing pattern of change in children's height measured over 3 annual assessments. The mean intercept value showed an average initial height of 55.29 inches (sd = 3.08), with evidence of individual variability around this estimate. The fixed effects estimates indicated year-to-year growth increments of approximately 2.42 inches in Year 1, 4.93 inches in Year 2, and 7.06 inches in Year 3 compared to the baseline.\n\nThe GLMM framework used in this example effectively accounted for both fixed effects, which estimate common parameters across all individuals, and random effects, which capture unique variations among individuals. This approach demonstrated its utility in handling clustered or correlated data arising from repeated measurements on the same subjects. The random intercepts effect suggested some between-subject variability in participants' height values at baseline, with a standard deviation of about 3.08 inches.\n\nMore generally, the GLMM approach is particularly useful in developmental studies as it allows for a more precise understanding of both group-level trends and individual-specific trajectories in longitudinal data. By accommodating individual differences in initial height and varying growth patterns over time, this method provides a comprehensive view of the dynamics of height changes in children.\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}