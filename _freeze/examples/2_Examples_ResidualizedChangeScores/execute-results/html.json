{
  "hash": "f6e0a7618b186df6f9beed22479e26a2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Residualized Change Scores\"\nauthor: \"Biostatistics Working Group\"\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n## Overview\nA residualized change score is a statistical approach used to account for the baseline (initial) values of a variable when measuring across two time points. First, a linear regression is conducted with the follow-up score predicted by the baseline score. The residual values from this model can be interpreted as change scores that have been adjusted for the baseline values. In a next step, regression analysis can be applied to determine whether a variable of interest predicts the residualized change score.\n\nThis example will examine whether handedness predicts changes in height from baseline to the 1 year follow-up, controlling for initial height measurements, in a sample of participants taking part in the ABCD Study. Initially, a linear regression analysis predicts height measurements at the 1 year follow-up from their baseline values to calculate residualized change scores. Subsequently, a second regression assesses whether handedness (left vs. right) predicts these residualized changes in height measurements. The relationship is also visually represented through a violin plot, illustrating differences in the residualized height values between left-handed and right-handed individuals.\n\n## Preliminary Setup\n### Load Packages\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse) # Collection of R packages for data science\nlibrary(gtsummary) # Publication-ready tables\nlibrary(rstatix) # Statistical Tests in tidy format\nlibrary(lme4) # Linear mixed-effects models\n```\n:::\n\n\n### Descriptives\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndescriptives_table <- df_long %>%\n    select(event, handedness, height) %>%\n    mutate(event = factor(event)) %>%\n    mutate(handedness = factor(handedness)) %>%\n    tbl_summary(\n        by = event,\n        missing = \"no\",\n        label = list(handedness ~ \"Handedness\", height ~ \"Height\"),\n        statistic = list(all_continuous() ~ \"{mean} ({sd}) )\", all_categorical() ~ \"{p}%\"),\n    ) %>%\n    modify_header(all_stat_cols() ~ \"**{level}**<br>N = {n}\") %>%\n    bold_labels() %>%\n    italicize_levels() %>%\n    modify_spanning_header(all_stat_cols() ~ \"**Assessment Wave**\")\ntheme_gtsummary_compact()\n\ndescriptives_table\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ltfuooshbw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ltfuooshbw table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ltfuooshbw thead, #ltfuooshbw tbody, #ltfuooshbw tfoot, #ltfuooshbw tr, #ltfuooshbw td, #ltfuooshbw th {\n  border-style: none;\n}\n\n#ltfuooshbw p {\n  margin: 0;\n  padding: 0;\n}\n\n#ltfuooshbw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 13px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ltfuooshbw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ltfuooshbw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ltfuooshbw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ltfuooshbw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ltfuooshbw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ltfuooshbw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ltfuooshbw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ltfuooshbw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ltfuooshbw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ltfuooshbw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ltfuooshbw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ltfuooshbw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ltfuooshbw .gt_group_heading {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ltfuooshbw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ltfuooshbw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ltfuooshbw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ltfuooshbw .gt_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ltfuooshbw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ltfuooshbw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ltfuooshbw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ltfuooshbw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ltfuooshbw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ltfuooshbw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ltfuooshbw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ltfuooshbw .gt_last_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ltfuooshbw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ltfuooshbw .gt_first_grand_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ltfuooshbw .gt_last_grand_summary_row_top {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ltfuooshbw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ltfuooshbw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ltfuooshbw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ltfuooshbw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ltfuooshbw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ltfuooshbw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ltfuooshbw .gt_left {\n  text-align: left;\n}\n\n#ltfuooshbw .gt_center {\n  text-align: center;\n}\n\n#ltfuooshbw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ltfuooshbw .gt_font_normal {\n  font-weight: normal;\n}\n\n#ltfuooshbw .gt_font_bold {\n  font-weight: bold;\n}\n\n#ltfuooshbw .gt_font_italic {\n  font-style: italic;\n}\n\n#ltfuooshbw .gt_super {\n  font-size: 65%;\n}\n\n#ltfuooshbw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ltfuooshbw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ltfuooshbw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ltfuooshbw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ltfuooshbw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ltfuooshbw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ltfuooshbw .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"&lt;strong&gt;Assessment Wave&lt;/strong&gt;\">\n        <span class=\"gt_column_spanner\"><strong>Assessment Wave</strong></span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Baseline&lt;/strong&gt;&lt;br&gt;N = 10263&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Baseline</strong><br>N = 10263<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Year_1&lt;/strong&gt;&lt;br&gt;N = 9629&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Year_1</strong><br>N = 9629<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">Handedness</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-style: italic;\">    Right</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">92%</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">92%</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-style: italic;\">    Left</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">8.3%</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">8.3%</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">Height</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">55.2 (3.3) )</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">57.6 (3.6) )</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"3\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> %; Mean (SD) )</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n## Results\n### Compute Multiple Regression Model\nThe code below is used to compute a residualized change score by first adjusting participants' height at the 1-year follow-up for their baseline height through a regression analysis. The residuals from this model represent the adjusted height changes that are not explained by their initial measurements. Subsequently, these residualized change scores are used in a simple regression analysis to explore whether handedness predicts the changes in height between the two timepoints. This approach helps to isolate any effect of handedness on height growth, independent of the baseline height values.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Reshape data from long to wide format\ndf_wide <- df_long %>%\n    pivot_wider(\n        names_from = event,\n        values_from = height,\n        names_prefix = \"Height_\"\n    )\n\n# Step 1: Fit the linear model to get residuals\nmodel_baseline <- lm(Height_Year_1 ~ Height_Baseline, data = df_wide, na.action = na.exclude)\ndf_wide <- df_wide %>%\n    mutate(residualized_change = residuals(model_baseline))\n\n# Step 2: Model residualized change scores predicted by handedness\nmodel_residualized_change <- lm(residualized_change ~ handedness, data = df_wide, na.action = na.exclude)\n\n# View the summary of the model to see the effect of handedness\nsummary(model_residualized_change)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = residualized_change ~ handedness, data = df_wide, \n    na.action = na.exclude)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-53.91  -0.80  -0.09   0.70  65.53 \n\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)\n(Intercept)    -0.00555    0.02477   -0.22     0.82\nhandednessLeft  0.06693    0.08600    0.78     0.44\n\nResidual standard error: 2.33 on 9627 degrees of freedom\n  (634 observations deleted due to missingness)\nMultiple R-squared:  6.29e-05,\tAdjusted R-squared:  -4.1e-05 \nF-statistic: 0.606 on 1 and 9627 DF,  p-value: 0.436\n```\n\n\n:::\n:::\n\n\nThe results from the residualized change score analysis suggest that while individual differences in growth occurs, handedness does not appear to be a determining factor. The model intercept, close to zero (-0.005), is consistent with the expectation that if there is no effect for handedness, there would be no change when adjusting for baseline heights. Further, examination of the model residuals (range = -53.90 to 65.53, se = 2.32) and the negligible r-squared value indicates that handedness does not explain a substantive portion of the variance in residualized height changes.\n\n### Model Plots\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2)) # Set up a 2x2 plotting area\nplot(model_baseline) # Generate diagnostic plots\n```\n\n::: {.cell-output-display}\n![](2_Examples_ResidualizedChangeScores_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=75%}\n:::\n\n```{.r .cell-code}\n# Visualize the residualized change scores across different levels of handedness\n\n# Create a violin plot to show the distribution of residualized change scores by handedness\n# Jittered points are added to provide a more granular view of individual observations\n# Load necessary libraries\nlibrary(RColorBrewer)\n\n# Plotting using ggplot2\nggplot(df_long, aes(x = handedness, y = height, fill = handedness)) +\n    geom_violin() +\n    geom_jitter(position = position_jitter(width = 0.2), size = 1, alpha = 0.5) +\n    scale_fill_brewer(palette = \"Set2\") +\n    labs(\n        title = \"Residualized Change Score by Handedness\",\n        x = \"Handedness\",\n        y = \"Height Change Score\"\n    ) +\n    theme_minimal() +\n    theme(\n        axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"none\"\n    )\n```\n\n::: {.cell-output-display}\n![](2_Examples_ResidualizedChangeScores_files/figure-html/unnamed-chunk-6-2.png){fig-align='center' width=75%}\n:::\n:::\n\n\nThe violin plot visualizes the distribution of residualized change scores in children's heights by their handedness (Right, Left). Each violin shape provides insight into the density of the data at different (residualized) height values, with wider sections representing higher densities of data points. Superimposed jittered points offer a granular view of individual observations. From the plot, it appears that the overall distributions of the residualized change scores for the height outcome across the two handedness categories are markedly similar.\n\n## Wrapping Up\nThis analysis evaluated residualized change scores of participants' height over a one-year period, controlling for initial height measurements at baseline. It then utilized a simple regression analysis to investigate handedness as a predictor of these adjusted changes in height. Findings demonstrated a non-significant effect of handedness on the residualized height values, with left-handed individuals showing an average height change increase of .06 inches (r = .77, se = .08, p = .43) more than right-handed individuals. A visual inspection using a violin plot further supported these results, showing overlapping distributions of residualized height changes across handedness categories, indicating no substantial effect.\n\nThis approach of using residualized change scores can be particularly valuable when initial measurement levels may influence the outcome. In some context, this analysis can provide a more accurate reflection of change by accounting for baseline values, making it suitable for analyses where measurement of change is a primary aim and where baseline characteristics might otherwise obscure true changes.\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}