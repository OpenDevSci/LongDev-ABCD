{
  "hash": "cbf6ed6c9b1a6a933648da8996c57301",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Signed-Rank Test\"\nauthor: \"Biostatistics Working Group\"\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n## Overview\nThe Signed Rank-Sum test is a non-parametric method used to compare paired samples or repeated measures. Unlike traditional parametric tests, it does not assume normality and is particularly useful when dealing with skewed distributions or ordinal data. This method extends the Wilcoxon signed rank-sum test to handle multiple measurements over time, making it suitable for longitudinal data analysis.\n\nThis example will examine changes in height across 3 annual measurement occasions in a sample of youth taking part in the ABCD Study. The primary aim is to determine whether there are significant changes in height over time, while accounting for observations that are clustered within youth over time. The signed rank-sum test will help us identify whether height levels have significantly increased or decreased across the three time points without making parametric assumptions about the data distribution.\n\n## Preliminary Setup\n### Load Packages\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse) # Collection of R packages for data science\nlibrary(gtsummary) # Publication-ready tables\nlibrary(rstatix) # Statistical Tests in tidy format\nlibrary(easystats) # \nlibrary(lme4) # Linear mixed-effects models\n```\n:::\n\n\n### Descriptives\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndescriptives_table <- df_long %>%\n    select(event, height) %>%\n    mutate(event = factor(event)) %>%\n    tbl_summary(\n        by = event,\n        missing = \"no\",\n        label = list(height ~ \"Height\"),\n        statistic = list(all_continuous() ~ \"{mean} ({sd})\", all_categorical() ~ \"{p}%\"),\n    ) %>%\n    modify_header(all_stat_cols() ~ \"**{level}**<br>N = {n}\") %>%\n    bold_labels() %>%\n    italicize_levels() %>%\n    modify_spanning_header(all_stat_cols() ~ \"**Assessment Wave**\")\ntheme_gtsummary_compact()\n\ndescriptives_table\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"fyrrqvntsz\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#fyrrqvntsz table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#fyrrqvntsz thead, #fyrrqvntsz tbody, #fyrrqvntsz tfoot, #fyrrqvntsz tr, #fyrrqvntsz td, #fyrrqvntsz th {\n  border-style: none;\n}\n\n#fyrrqvntsz p {\n  margin: 0;\n  padding: 0;\n}\n\n#fyrrqvntsz .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 13px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fyrrqvntsz .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#fyrrqvntsz .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fyrrqvntsz .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fyrrqvntsz .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fyrrqvntsz .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fyrrqvntsz .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fyrrqvntsz .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fyrrqvntsz .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fyrrqvntsz .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fyrrqvntsz .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fyrrqvntsz .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fyrrqvntsz .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#fyrrqvntsz .gt_group_heading {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#fyrrqvntsz .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fyrrqvntsz .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fyrrqvntsz .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fyrrqvntsz .gt_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fyrrqvntsz .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fyrrqvntsz .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fyrrqvntsz .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fyrrqvntsz .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#fyrrqvntsz .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fyrrqvntsz .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fyrrqvntsz .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fyrrqvntsz .gt_last_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fyrrqvntsz .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fyrrqvntsz .gt_first_grand_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fyrrqvntsz .gt_last_grand_summary_row_top {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fyrrqvntsz .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fyrrqvntsz .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fyrrqvntsz .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fyrrqvntsz .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fyrrqvntsz .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fyrrqvntsz .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fyrrqvntsz .gt_left {\n  text-align: left;\n}\n\n#fyrrqvntsz .gt_center {\n  text-align: center;\n}\n\n#fyrrqvntsz .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fyrrqvntsz .gt_font_normal {\n  font-weight: normal;\n}\n\n#fyrrqvntsz .gt_font_bold {\n  font-weight: bold;\n}\n\n#fyrrqvntsz .gt_font_italic {\n  font-style: italic;\n}\n\n#fyrrqvntsz .gt_super {\n  font-size: 65%;\n}\n\n#fyrrqvntsz .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#fyrrqvntsz .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fyrrqvntsz .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fyrrqvntsz .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fyrrqvntsz .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fyrrqvntsz .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fyrrqvntsz .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"4\" scope=\"colgroup\" id=\"&lt;strong&gt;Assessment Wave&lt;/strong&gt;\">\n        <span class=\"gt_column_spanner\"><strong>Assessment Wave</strong></span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Baseline&lt;/strong&gt;&lt;br&gt;N = 2818&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Baseline</strong><br>N = 2818<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Year_1&lt;/strong&gt;&lt;br&gt;N = 2818&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Year_1</strong><br>N = 2818<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Year_2&lt;/strong&gt;&lt;br&gt;N = 2818&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Year_2</strong><br>N = 2818<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Year_3&lt;/strong&gt;&lt;br&gt;N = 2818&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Year_3</strong><br>N = 2818<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">Height</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">55.1 (3.6)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">57.5 (3.7)</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">60.3 (3.6)</td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\">62.3 (4.1)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> Mean (SD)</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n## Results \n### Compute Signed Rank Test\nThis code performs a Signed Rank-Sum Test to compare 'Height' across 3 annual visits, focusing on the changes in height over time. The output of the test is provided below, along with a summary of results. This non-parametric test accounts for the paired nature of the observations and determines whether there are significant changes in height across the three time points without assuming a specific distribution for the data.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Reshape data from long to wide format\ndf_wide <- df_long %>%\n    pivot_wider(\n        id_cols = c(id),\n        names_from = event,\n        values_from = height,\n        names_prefix = \"Height_\"\n    )\n\ndf_wide$Height_Baseline <- as.numeric(as.character(df_wide$Height_Baseline))\ndf_wide$Height_Year_1 <- as.numeric(as.character(df_wide$Height_Year_1))\n\ndf_wide_complete <- na.omit(df_wide[, c(\"Height_Baseline\", \"Height_Year_1\")])\n\nmodel <- wilcox.test(df_wide_complete$Height_Baseline, df_wide_complete$Height_Year_1, paired = TRUE)\n\nreport(wilcox.test(df_wide_complete$Height_Baseline, df_wide_complete$Height_Year_1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEffect sizes were labelled following Funder's (2019) recommendations.\n\nThe Wilcoxon rank sum test with continuity correction testing the difference in ranks between df_wide_complete$Height_Baseline and df_wide_complete$Height_Year_1 suggests that the effect is negative, statistically\nsignificant, and large (W = 2.41e+06, p < .001; r (rank biserial) = -0.39, 95% CI [-0.42, -0.37])\n```\n\n\n:::\n:::\n\nThese results indicate a significant increase in height from baseline to Year 1, as evidenced by the Wilcoxon signed rank-sum test. The test statistic (W = 2.41e+06) and the negative rank biserial correlation (r = -0.39) suggest a large effect size, with the p-value (< .001) confirming the statistical significance of the observed changes. This analysis shows that participants' heights have significantly increased from baseline to Year 1.\n\n### Model Plots\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(df_long, aes(x = event, y = height, group = id)) +\n  geom_line(aes(group = id), alpha = 0.3, color = \"grey\") +  # Individual trajectories\n  geom_boxplot() +  # Boxplot for summary statistics\n  labs(title = \"Comparison of Height Measurements Across Time Points\",\n       x = \"Time Point\", y = \"Height (inches)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")  # Hide legend, if not necessary\n```\n\n::: {.cell-output-display}\n![](4_Examples_SignedRankTest_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=75%}\n:::\n:::\n\nThis plot illustrates the change in participants' height across 3 annual measurement occasions using a combination of individual trajectories and boxplots. The grey lines represent individual participants' height trajectories, demonstrating the variability among participants at each time point. The boxplots summarize the distribution of height measurements at each time point, highlighting the median, interquartile range, and potential outliers.\n\nThe plot reveals significant changes in height over time, with the median height increasing across the three measurement occasions. The individual trajectories show that while most participants experience an increase in height, the rate of growth varies. This visualization helps to identify trends and patterns in height changes, as well as the variability in growth among participants. The boxplots provide a clear summary of the central tendency and spread of height measurements at each time point, indicating that the overall height distribution shifts upwards over time.\n\n## Wrapping Up\nThe signed rank-sum test analysis revealed significant changes in children's height measured over 3 annual assessments. The Wilcoxon rank sum test with continuity correction between baseline and Year 1 indicated a significant increase in height (W = 2.41e+06, p < .001; r (rank biserial) = -0.39, 95% CI [-0.42, -0.37]). These results suggest a large effect size, with the p-value confirming the statistical significance of the observed changes. Participants' heights significantly increased from baseline to Year 1. This non-parametric method was particularly useful for handling the paired nature of the data and did not assume normality, making it suitable for skewed distributions often encountered in growth measurements.\n\nThe signed rank-sum test provided insights into overall changes in height without requiring parametric assumptions, demonstrating its utility in analyzing longitudinal data. This approach is valuable in developmental studies as it robustly detects significant changes over time, even with non-normal data distributions. By focusing on rank differences, the test highlights meaningful changes within individuals, offering a straightforward yet powerful method to examine growth patterns across repeated measurements.\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}