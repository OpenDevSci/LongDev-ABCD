{
  "hash": "f6694360d614f4af9f2b624631f517a6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Linear Mixed Models: Random Intercept and Slope\"\nauthor: \"Biostatistics Working Group\"\n\n---\n\n\n# LMM: Intercept & Slope {.unnumbered}\n\n## Overview\n\n<p>\n\nThe Linear Mixed Model with a random intercept and slope (LMM:ris) extends the traditional fixed-effect linear regression by incorporating both a subject-specific random intercept and a random slope. This allows each participant to have their own unique intercept and slope values, reflecting individual starting points and rates of change, in addition to the overall mean-level (fixed-effect) trajectory.\n\nIn this example, we will utilize the LMM:ris to analyze height trajectories obtained across multiple measurement occasions for a sample of youth participating in the ABCD Study. Our primary objective is to understand the stability and evolution in height measurements, while factoring in the clustered nature of observations within individuals over time. The LMM:ris facilitates this by concurrently modeling an overarching sample mean trajectory (fixed effect) and individual variations (random effects) in both starting points (intercepts) and growth rates (slopes) around this mean trajectory.\n\n</p>\n\n## Preliminary Setup\n\n::: panel-tabset\n### Install Packages {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n> **This code installs the r packages necessary for this example, if\n> they are not already installed**\n\n\n::: {.cell messages='false'}\n\n```{.r .cell-code}\n# Create a list of required packages\npackages_required <- c(\"tidyverse\",\"rstatix\",\"DT\",\"lme4\",\"report\",\"broom\",\"gridExtra\",\"easystats\",\"gtsummary\")\n\n# Check which packages are not installed and install them\npackages_to_install <- setdiff(packages_required, rownames(installed.packages()))\nif (length(packages_to_install) > 0) {\n    install.packages(packages_to_install)\n}\n\n# Load the required packages\nlapply(packages_required, library, character.only = TRUE)\n```\n:::\n\n:::\n\n### Load Packages\n\n::: blue\n**This code loads the r libraries necessary for this example**\n\n\n::: {.cell messages='false'}\n\n```{.r .cell-code}\nlibrary(tidyverse)    # Collection of R packages for data science\nlibrary(rstatix)      # Pipe-friendly framework for basic statistical tests\nlibrary(DT)           # Rendering interactive data tables\nlibrary(lme4)         # Linear mixed-effects models\nlibrary(report)       # Easy reporting of regression analyses\nlibrary(broom)        # Tidy and augment statistical models output\nlibrary(gridExtra)    # Arrange multiple grid-based plots on a page\nlibrary(easystats)    #\nlibrary(gtsummary)    #\n```\n:::\n\n:::\n\n### Config Options\n\n::: blue\n**This code configures knitr code chunk options**\n\n\n::: {.cell messages='false'}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, \n                      comment=NA, cache=T, code_folding=T,\n                      R.options=list(width=220, digits = 3),\n                      fig.align='center', \n                      out.width='75%', fig.asp=.75)\n```\n:::\n\n:::\n:::\n\n## Descriptives Overview\n\n::: panel-tabset\n### Read and View Data {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n**This code reads in and shows the data to be used in the current\nexample**\n\n\n::: {.cell layout-align=\"center\" messages='false'}\n\n```{.r .cell-code}\n# Set the data paths\ndata_path_1 <- \"/Users/shawes/ABCD/data/rds/abcd_5.0_rds/demo5.0.rds\"\ndata_path_2 <- \"/Users/shawes/ABCD/data/rds/abcd_5.0_rds/core-rds-5.0/non-imaging_excluding_nt_5.0.rds\"\n\n# Read the data\ndata_demographics <- readRDS(data_path_1)\ndata_nonimaging <- readRDS(data_path_2)\n\n# Subset the nonimaging data to include desired variables\nselected_vars <- c(\"src_subject_id\", \"eventname\", \"nihtbx_totalcomp_fc\", \"anthroweightcalc\", \"anthroheightcalc\")\nsubset_data <- data_nonimaging[, selected_vars]\n\nlibrary(dplyr)\n# # Merge the datasets on 'src_subject_id' and 'eventname'\nmerged_data <- data_demographics %>%\n  full_join(subset_data, by = c(\"src_subject_id\", \"eventname\"))\n\n# Inspect the merged data structure\nstr(merged_data)\n\n# Define event names to be retained in the analysis and convert variables to appropriate data types\neventnames_to_include <- c(\"baseline_year_1_arm_1\",\n                           \"1_year_follow_up_y_arm_1\",\n                           \"2_year_follow_up_y_arm_1\",\n                           \"3_year_follow_up_y_arm_1\",\n                           \"4_year_follow_up_y_arm_1\")\n\ndf <- merged_data %>%\n  filter(eventname %in% eventnames_to_include) %>%\n  mutate(\n    src_subject_id = as.factor(src_subject_id),\n    eventname = factor(eventname, levels = eventnames_to_include, ordered = TRUE),\n    age = as.numeric(age),\n    sex = as.factor(sex),\n    race.4level = as.factor(race.4level),\n    hisp = as.factor(hisp),\n    high.educ.bl = as.factor(high.educ.bl),\n    household.income.bl = as.factor(household.income.bl),\n    acs_raked_propensity_score = as.numeric(acs_raked_propensity_score),\n    rel_family_id.bl = as.factor(rel_family_id.bl),\n    site_id_l = as.factor(site_id_l),\n    nihtbx_totalcomp_fc = as.numeric(nihtbx_totalcomp_fc),\n    anthroweightcalc = as.numeric(anthroweightcalc),\n    anthroheightcalc = as.numeric(anthroheightcalc)\n  ) %>%\n  # Exclude cases from unused assessment waves\n  filter(!is.na(eventname))\n```\n:::\n\n:::\n\n### Descriptives\n\n::: blue\n**This code creates a descriptives table**\n\n\n::: {.cell layout-align=\"center\" messages='false'}\n\n```{.r .cell-code}\ndescriptives_table <- df %>%\n  select(eventname, sex, race.4level, hisp, anthroweightcalc) %>%\n  mutate(eventname = factor(eventname, labels = c(\"Baseline\", \"Year 1\",\"Year 2\",\"Year 3\",\"Year 4\"))) %>%\n  mutate(sex = factor(sex, labels = c(\"Female\", \"Male\"))) %>%\n  tbl_summary(\n    by = eventname,\n    missing = \"no\",\n    label = list(sex ~ \"Sex\", race.4level ~ \"Race\", hisp ~ \"Hispanic\", \n                 anthroweightcalc ~ \"Weight\"),\n    statistic = list(all_continuous() ~ \"{mean} ({sd}) )\", all_categorical() ~ \"{p}%\"),\n  ) %>%\nmodify_header(all_stat_cols() ~ \"**{level}**<br>N = {n}\") %>%\n  bold_labels() %>%\n  italicize_levels() %>%\n  modify_spanning_header(all_stat_cols() ~ \"**Assessment Wave**\")\ntheme_gtsummary_compact()\n\ndescriptives_table\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"tfxtbexakb\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#tfxtbexakb table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#tfxtbexakb thead, #tfxtbexakb tbody, #tfxtbexakb tfoot, #tfxtbexakb tr, #tfxtbexakb td, #tfxtbexakb th {\n  border-style: none;\n}\n\n#tfxtbexakb p {\n  margin: 0;\n  padding: 0;\n}\n\n#tfxtbexakb .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 13px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#tfxtbexakb .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#tfxtbexakb .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#tfxtbexakb .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#tfxtbexakb .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tfxtbexakb .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tfxtbexakb .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tfxtbexakb .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#tfxtbexakb .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#tfxtbexakb .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#tfxtbexakb .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#tfxtbexakb .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#tfxtbexakb .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#tfxtbexakb .gt_group_heading {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#tfxtbexakb .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#tfxtbexakb .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#tfxtbexakb .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#tfxtbexakb .gt_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#tfxtbexakb .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tfxtbexakb .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#tfxtbexakb .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#tfxtbexakb .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#tfxtbexakb .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tfxtbexakb .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#tfxtbexakb .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#tfxtbexakb .gt_last_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tfxtbexakb .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tfxtbexakb .gt_first_grand_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#tfxtbexakb .gt_last_grand_summary_row_top {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tfxtbexakb .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#tfxtbexakb .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tfxtbexakb .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tfxtbexakb .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tfxtbexakb .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tfxtbexakb .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tfxtbexakb .gt_left {\n  text-align: left;\n}\n\n#tfxtbexakb .gt_center {\n  text-align: center;\n}\n\n#tfxtbexakb .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#tfxtbexakb .gt_font_normal {\n  font-weight: normal;\n}\n\n#tfxtbexakb .gt_font_bold {\n  font-weight: bold;\n}\n\n#tfxtbexakb .gt_font_italic {\n  font-style: italic;\n}\n\n#tfxtbexakb .gt_super {\n  font-size: 65%;\n}\n\n#tfxtbexakb .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#tfxtbexakb .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#tfxtbexakb .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#tfxtbexakb .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#tfxtbexakb .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#tfxtbexakb .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#tfxtbexakb .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"5\" scope=\"colgroup\" id=\"&lt;strong&gt;Assessment Wave&lt;/strong&gt;\">\n        <span class=\"gt_column_spanner\"><strong>Assessment Wave</strong></span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Baseline&lt;/strong&gt;&lt;br&gt;N = 11868&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Baseline</strong><br>N = 11868<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Year 1&lt;/strong&gt;&lt;br&gt;N = 11220&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Year 1</strong><br>N = 11220<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Year 2&lt;/strong&gt;&lt;br&gt;N = 10973&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Year 2</strong><br>N = 10973<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Year 3&lt;/strong&gt;&lt;br&gt;N = 10336&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Year 3</strong><br>N = 10336<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Year 4&lt;/strong&gt;&lt;br&gt;N = 4754&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Year 4</strong><br>N = 4754<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">Sex</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_5\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-style: italic;\">    Female</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">48%</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">48%</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">48%</td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\">47%</td>\n<td headers=\"stat_5\" class=\"gt_row gt_center\">48%</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-style: italic;\">    Male</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">52%</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">52%</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">52%</td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\">53%</td>\n<td headers=\"stat_5\" class=\"gt_row gt_center\">52%</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">Race</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_5\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-style: italic;\">    Asian</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">0.5%</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">0.4%</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">0.4%</td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\">0.5%</td>\n<td headers=\"stat_5\" class=\"gt_row gt_center\">0.4%</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-style: italic;\">    Black</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">16%</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">15%</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">15%</td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\">14%</td>\n<td headers=\"stat_5\" class=\"gt_row gt_center\">12%</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-style: italic;\">    Other/Mixed</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">17%</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">17%</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">17%</td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\">17%</td>\n<td headers=\"stat_5\" class=\"gt_row gt_center\">16%</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-style: italic;\">    White</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">66%</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">67%</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">67%</td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\">68%</td>\n<td headers=\"stat_5\" class=\"gt_row gt_center\">72%</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">Hispanic</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">21%</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">20%</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">20%</td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\">20%</td>\n<td headers=\"stat_5\" class=\"gt_row gt_center\">21%</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">Weight</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">83 (24) )</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">94 (28) )</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">109 (49) )</td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\">123 (38) )</td>\n<td headers=\"stat_5\" class=\"gt_row gt_center\">139 (111) )</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"6\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> %; Mean (SD) )</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n:::\n:::\n\n## Results \n\n::: panel-tabset\n### Build Model {.tabset .tabset-fade .tabset-pills}\n\n::: blue\nThe code fits a linear mixed model to examine the 'Height' variable across time points ('eventname'). It incorporates both random intercepts and slopes for the time points ('eventname') within each participant ('src_subject_id') to capture individual-level variability in both starting values and rates of change over time. The results of the model are then printed to provide a detailed summary of the fitted model parameters.\n\n**STEP 1: Compute LMM with Random Intercepts and Slopes**\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .fold-hide .cell-code}\n## Linear Mixed Model with a random intercept and random slope (LMM-ris)\nrandom_intercepts_slopes <- lmer(anthroheightcalc ~ 1 + eventname + (1|src_subject_id), data = df, REML=T)\n\nprint(random_intercepts_slopes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: anthroheightcalc ~ 1 + eventname + (1 | src_subject_id)\n   Data: df\nREML criterion at convergence: 201982\nRandom effects:\n Groups         Name        Std.Dev.\n src_subject_id (Intercept) 2.96    \n Residual                   2.26    \nNumber of obs: 40172, groups:  src_subject_id, 11867\nFixed Effects:\n(Intercept)  eventname.L  eventname.Q  eventname.C  eventname^4  \n    60.0627       7.5412      -0.1736      -0.0703       0.1542  \n```\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\" messages='false'}\n\n```{.r .cell-code}\n## Output and reports extending from the LMM-ris analyses\nsummary(random_intercepts_slopes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: anthroheightcalc ~ 1 + eventname + (1 | src_subject_id)\n   Data: df\n\nREML criterion at convergence: 201982\n\nScaled residuals: \n   Min     1Q Median     3Q    Max \n-21.00  -0.31  -0.01   0.32  65.93 \n\nRandom effects:\n Groups         Name        Variance Std.Dev.\n src_subject_id (Intercept) 8.76     2.96    \n Residual                   5.12     2.26    \nNumber of obs: 40172, groups:  src_subject_id, 11867\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  60.0627     0.0304 1972.86\neventname.L   7.5412     0.0308  244.55\neventname.Q  -0.1736     0.0290   -5.99\neventname.C  -0.0703     0.0320   -2.20\neventname^4   0.1542     0.0286    5.39\n\nCorrelation of Fixed Effects:\n            (Intr) evnt.L evnt.Q evnt.C\neventname.L  0.218                     \neventname.Q  0.024  0.258              \neventname.C -0.075 -0.031  0.389       \neventname^4 -0.072 -0.089  0.208  0.435\n```\n\n\n:::\n\n```{.r .cell-code}\nconfint(random_intercepts_slopes, level = 0.95, method = \"Wald\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              2.5 %   97.5 %\n.sig01           NA       NA\n.sigma           NA       NA\n(Intercept) 60.0030 60.12236\neventname.L  7.4808  7.60168\neventname.Q -0.2304 -0.11682\neventname.C -0.1330 -0.00762\neventname^4  0.0981  0.21032\n```\n\n\n:::\n\n```{.r .cell-code}\nreport_performance(random_intercepts_slopes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nThe model's total explanatory power is substantial (conditional R2 = 0.78) and the part related to the fixed effects alone (marginal R2) is of 0.41\n```\n\n\n:::\n:::\n\n\nThe code fits a Linear Mixed Model (LMM:ris) to predict children's height based on different time points (denoted as eventname). Individual variability is captured through random intercepts associated with each participant (src_subject_id). The results suggest a significant change in height across the time points, with the model accounting for 89% (r round(conditional_R2, 2)) of the total variation and 37% (r round(marginal_R2, 2)) attributed to the fixed effects alone.\n\nIn the model, the linear term for eventname has an estimated effect of r round(model_summary$coefficients[\"eventname.L\", \"Estimate\"], 2), indicating a significant increase in height across time points. Additionally, there's variability in initial height across participants, reflected by a random intercept standard deviation of r round(random_effects[\"src_subject_id\", \"Std.Dev.\"], 2).\n\n:::\n\n### Model Plots\n\n::: blue\nThe following set of plots are used to facilitate model diagnostics. The first is a histogram showcasing the distribution of random intercepts for individual subjects, indicating variations in height not explained by the fixed effects. The second depicts residuals versus fitted values, helping assess the model's fit and potential heteroscedasticity. The third contrasts observed and predicted height values across different time points, offering a side-by-side evaluation of the model's predictions against actual observations.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Assuming your model is named `random_intercepts_slope`\n# 1. Extract the random effects\nrandom_effects <- ranef(random_intercepts_slopes)[[1]]\n\n# 2. Convert to dataframe\nrandom_effects_df <- data.frame(Intercept = random_effects$`(Intercept)`)\n\n# Plot 1: Histogram\n# Plot 1: Histogram\nhist_plot <- ggplot(random_effects_df, aes(x = Intercept)) +\n  geom_histogram(aes(y = ..density..), bins = 30, color = \"black\", fill = \"lightblue\") +\n  labs(title = \"Histogram of Random Effects\", x = \"Random Intercept Values\", y = \"Density\") +\n  theme_minimal()\n\nprint(hist_plot)\n```\n\n::: {.cell-output-display}\n![](3b_Examples_LinearMixedModels_files/figure-html/diagnosticplots-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Extract the data frame used in the model\nmodel_data <- random_intercepts_slopes@frame\n\n# Extract unique subject IDs from the model's data\noriginal_subject_ids <- unique(model_data$src_subject_id)\n\n# Subset the original data to include only those subjects\ndf_subset <- df %>% filter(src_subject_id %in% original_subject_ids)\n\neventname_map <- c(\n  \"baseline_year_1_arm_1\" = \"Baseline\",\n  \"1_year_follow_up_y_arm_1\" = \"Year_1\",\n  \"2_year_follow_up_y_arm_1\" = \"Year_2\",\n  \"3_year_follow_up_y_arm_1\" = \"Year_3\",\n  \"4_year_follow_up_y_arm_1\" = \"Year_4\"\n)\n\n# Plot\nggplot(df, aes(x = eventname, y = anthroheightcalc, group = src_subject_id)) +\n  \n# Individual estimated height trajectories in faded lines\ngeom_line(aes(group = src_subject_id), alpha = 0.3, color = \"grey50\") +\n\n# Overall group-mean trajectory in blue with increased thickness\nstat_summary(aes(group = 1), fun = mean, geom = \"line\", color = \"blue\", linewidth = 1) +\nlabs(title = \"Individual and Group-Mean Height Trajectories\",\n     x = \"Event Name\",\n     y = \"Height\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](3b_Examples_LinearMixedModels_files/figure-html/trajectoryplot-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\nThe provided code visualizes individual and group-mean height trajectories over different event names. Individual height trajectories for each subject are depicted as faded gray lines, allowing for a clear view of the variability among subjects. In contrast, the overall group-mean trajectory, which represents the average trend across all individuals for each event name, is highlighted in blue. The average height at r mean(df_descriptable$Height) has increased by r mean(df_descriptable$Height_followup - df_descriptable$Height) units from baseline.\n:::\n\n## Wrapping Up\n<div class = \"blue\">\n\n::: panel-tabset\n### Write-up {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n\nThe linear mixed model analysis was conducted to predict children's height across different time points (Baseline, Year_1, Year_2, Year_3, and Year_4). The eventname predictor was statistically significant with a p-value of r format.pval(fixed_effects$Pr(>|t|)[2], digits = 3). The model's overall ability to explain the variance in height was xxxxx, with a conditional R^2 of r report_performance(random_intercepts)$Conditional R2[1], indicating that it accounted for this proportion of the variability in height when considering both fixed and random effects. The marginal R^2 was r report_performance(random_intercepts)$Marginal R2[1], meaning that the fixed effects alone explained this proportion of the variability.\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}