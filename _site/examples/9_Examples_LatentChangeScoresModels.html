<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Biostatistics Working Group">

<title>Longitudinal Analysis - Latent Change Score Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href=".././img/lights.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<meta property="og:title" content="Longitudinal Analysis - Latent Change Score Models">
<meta property="og:description" content="">
<meta property="og:site_name" content="Longitudinal Analysis">
<meta name="twitter:title" content="Longitudinal Analysis - Latent Change Score Models">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Longitudinal Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../manuscript/manuscript.html"> 
<span class="menu-text">Manuscript</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../examples/examples.html"> 
<span class="menu-text">ABCD Examples</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/opendevsci/LongDev-ABCD">
            Go to Project Repository
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/opendevsci/LongDev-ABCD/issues">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Latent Change Score Models</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Biostatistics Working Group </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>Latent change score models are a statistical technique used for analyzing changes over time by integrating aspects of both structural equation modeling and traditional change score methods. This approach constructs latent variables that directly represent change between time points. First, latent variables for each time point are modeled to capture the true score of the variable of interest, adjusting for measurement error. Then, latent change scores are defined as the difference between latent variables across consecutive time points.</p>
<p>This example will explore changes in height from baseline to 3 subsequent annual follow-ups in a sample of participants from the ABCD Study. Initially, latent variables for height at each time point are defined to account for measurement error and capture the true height scores. Latent change scores are then calculated between each pair of consecutive time points to model the true change in height. The dynamics of these changes are visually depicted using trajectory plots, providing a clear visual representation of growth patterns across participants the study.</p>
</section>
<section id="preliminary-setup" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-setup">Preliminary Setup</h2>
<section id="load-packages" class="level3">
<h3 class="anchored" data-anchor-id="load-packages">Load Packages</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Collection of R packages for data science</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(gtsummary) <span class="co"># Publication-ready tables</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(rstatix) <span class="co"># Statistical Tests in tidy format</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(lme4) <span class="co"># Linear mixed-effects models</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(lcsm) <span class="co"># Latent Change Score Models</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(lavaan) <span class="co"># Structural Equation Modeling</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(kableExtra) <span class="co"># Table formatting</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="descriptives" class="level3">
<h3 class="anchored" data-anchor-id="descriptives">Descriptives</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>descriptives_table <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>    <span class="fu">select</span>(event, height) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>    <span class="fu">mutate</span>(<span class="at">event =</span> <span class="fu">factor</span>(event)) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>    <span class="fu">tbl_summary</span>(</span>
<span id="cb2-5"><a href="#cb2-5"></a>        <span class="at">by =</span> event,</span>
<span id="cb2-6"><a href="#cb2-6"></a>        <span class="at">missing =</span> <span class="st">"no"</span>,</span>
<span id="cb2-7"><a href="#cb2-7"></a>        <span class="at">label =</span> <span class="fu">list</span>(height <span class="sc">~</span> <span class="st">"Height"</span>),</span>
<span id="cb2-8"><a href="#cb2-8"></a>        <span class="at">statistic =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd}) )"</span>, <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"{p}%"</span>),</span>
<span id="cb2-9"><a href="#cb2-9"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>    <span class="fu">modify_header</span>(<span class="fu">all_stat_cols</span>() <span class="sc">~</span> <span class="st">"**{level}**&lt;br&gt;N = {n}"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>    <span class="fu">bold_labels</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>    <span class="fu">italicize_levels</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>    <span class="fu">modify_spanning_header</span>(<span class="fu">all_stat_cols</span>() <span class="sc">~</span> <span class="st">"**Assessment Wave**"</span>)</span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="fu">theme_gtsummary_compact</span>()</span>
<span id="cb2-15"><a href="#cb2-15"></a></span>
<span id="cb2-16"><a href="#cb2-16"></a>descriptives_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<div id="twhfflddzz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#twhfflddzz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#twhfflddzz thead, #twhfflddzz tbody, #twhfflddzz tfoot, #twhfflddzz tr, #twhfflddzz td, #twhfflddzz th {
  border-style: none;
}

#twhfflddzz p {
  margin: 0;
  padding: 0;
}

#twhfflddzz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#twhfflddzz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#twhfflddzz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#twhfflddzz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#twhfflddzz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#twhfflddzz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twhfflddzz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#twhfflddzz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#twhfflddzz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#twhfflddzz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#twhfflddzz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#twhfflddzz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#twhfflddzz .gt_spanner_row {
  border-bottom-style: hidden;
}

#twhfflddzz .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#twhfflddzz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#twhfflddzz .gt_from_md > :first-child {
  margin-top: 0;
}

#twhfflddzz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#twhfflddzz .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#twhfflddzz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#twhfflddzz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#twhfflddzz .gt_row_group_first td {
  border-top-width: 2px;
}

#twhfflddzz .gt_row_group_first th {
  border-top-width: 2px;
}

#twhfflddzz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#twhfflddzz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#twhfflddzz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#twhfflddzz .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twhfflddzz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#twhfflddzz .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#twhfflddzz .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#twhfflddzz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#twhfflddzz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twhfflddzz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#twhfflddzz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#twhfflddzz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#twhfflddzz .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#twhfflddzz .gt_left {
  text-align: left;
}

#twhfflddzz .gt_center {
  text-align: center;
}

#twhfflddzz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#twhfflddzz .gt_font_normal {
  font-weight: normal;
}

#twhfflddzz .gt_font_bold {
  font-weight: bold;
}

#twhfflddzz .gt_font_italic {
  font-style: italic;
}

#twhfflddzz .gt_super {
  font-size: 65%;
}

#twhfflddzz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#twhfflddzz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#twhfflddzz .gt_indent_1 {
  text-indent: 5px;
}

#twhfflddzz .gt_indent_2 {
  text-indent: 10px;
}

#twhfflddzz .gt_indent_3 {
  text-indent: 15px;
}

#twhfflddzz .gt_indent_4 {
  text-indent: 20px;
}

#twhfflddzz .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" id="<strong>Characteristic</strong>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th colspan="4" id="<strong>Assessment Wave</strong>" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"><strong>Assessment Wave</strong></span></th>
</tr>
<tr class="odd gt_col_headings">
<th id="<strong>Baseline</strong><br>N = 2818<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Baseline</strong><br>
N = 2818<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="<strong>Year_1</strong><br>N = 2818<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Year_1</strong><br>
N = 2818<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="<strong>Year_2</strong><br>N = 2818<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Year_2</strong><br>
N = 2818<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="<strong>Year_3</strong><br>N = 2818<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Year_3</strong><br>
N = 2818<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Height</td>
<td class="gt_row gt_center" headers="stat_1">55.1 (3.6) )</td>
<td class="gt_row gt_center" headers="stat_2">57.5 (3.7) )</td>
<td class="gt_row gt_center" headers="stat_3">60.3 (3.6) )</td>
<td class="gt_row gt_center" headers="stat_4">62.3 (4.1) )</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Mean (SD) )</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<section id="compute-latent-change-score-model" class="level3">
<h3 class="anchored" data-anchor-id="compute-latent-change-score-model">Compute Latent Change Score Model</h3>
<p>The code below is used to compute a latent change score analysis to investigate changes in height across four annual assessments. This statistical approach models growth factors, including constant and proportional changes, and how they vary between individuals. It also evaluates the stability of growth patterns over time, giving a more nuanced understanding of developmental trajectories and the amount of change between each time point.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Reshape data from long to wide format</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>df_wide <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb3-4"><a href="#cb3-4"></a>        <span class="at">id_cols =</span> <span class="fu">c</span>(id),</span>
<span id="cb3-5"><a href="#cb3-5"></a>        <span class="at">names_from =</span> event,</span>
<span id="cb3-6"><a href="#cb3-6"></a>        <span class="at">values_from =</span> height,</span>
<span id="cb3-7"><a href="#cb3-7"></a>        <span class="at">names_prefix =</span> <span class="st">"Height_"</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>    )</span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a>df_wide <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(df_wide)</span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co"># Fit lcsm and save the results</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>uni_lavaan_results <span class="ot">&lt;-</span> <span class="fu">fit_uni_lcsm</span>(</span>
<span id="cb3-14"><a href="#cb3-14"></a>    <span class="at">data =</span> df_wide,</span>
<span id="cb3-15"><a href="#cb3-15"></a>    <span class="at">var =</span> <span class="fu">c</span>(</span>
<span id="cb3-16"><a href="#cb3-16"></a>        <span class="st">"Height_Baseline"</span>, <span class="st">"Height_Year_1"</span>,</span>
<span id="cb3-17"><a href="#cb3-17"></a>        <span class="st">"Height_Year_2"</span>, <span class="st">"Height_Year_3"</span></span>
<span id="cb3-18"><a href="#cb3-18"></a>    ),</span>
<span id="cb3-19"><a href="#cb3-19"></a>    <span class="at">model =</span> <span class="fu">list</span>(</span>
<span id="cb3-20"><a href="#cb3-20"></a>        <span class="at">alpha_constant =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-21"><a href="#cb3-21"></a>        <span class="at">beta =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-22"><a href="#cb3-22"></a>        <span class="at">phi =</span> <span class="cn">TRUE</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>    )</span>
<span id="cb3-24"><a href="#cb3-24"></a>)</span>
<span id="cb3-25"><a href="#cb3-25"></a></span>
<span id="cb3-26"><a href="#cb3-26"></a>uni_lavaan_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 63 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14
  Number of equality constraints                     6

  Number of observations                          2818
  Number of missing patterns                         1

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               369.370      11.468
  Degrees of freedom                                 6           6
  P-value (Chi-square)                           0.000       0.075
  Scaling correction factor                                 32.208
    Yuan-Bentler correction (Mplus variant)                       </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Save the lavaan syntax that is used to create the layout matrix for semPlot</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>uni_lavaan_syntax <span class="ot">&lt;-</span> <span class="fu">fit_uni_lcsm</span>(</span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="at">data =</span> df_wide,</span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="at">var =</span> <span class="fu">c</span>(</span>
<span id="cb5-5"><a href="#cb5-5"></a>        <span class="st">"Height_Baseline"</span>, <span class="st">"Height_Year_1"</span>,</span>
<span id="cb5-6"><a href="#cb5-6"></a>        <span class="st">"Height_Year_2"</span>, <span class="st">"Height_Year_3"</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>    ),</span>
<span id="cb5-8"><a href="#cb5-8"></a>    <span class="at">model =</span> <span class="fu">list</span>(</span>
<span id="cb5-9"><a href="#cb5-9"></a>        <span class="at">alpha_constant =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-10"><a href="#cb5-10"></a>        <span class="at">beta =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-11"><a href="#cb5-11"></a>        <span class="at">phi =</span> <span class="cn">TRUE</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>    ),</span>
<span id="cb5-13"><a href="#cb5-13"></a>    <span class="at">return_lavaan_syntax =</span> <span class="cn">TRUE</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>)</span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co"># Now extract parameter estimates</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co"># Only extract first 7 columns for this example by adding [ , 1:7]</span></span>
<span id="cb5-18"><a href="#cb5-18"></a>param_bi_lcsm_01 <span class="ot">&lt;-</span> <span class="fu">extract_param</span>(uni_lavaan_results, <span class="at">printp =</span> <span class="cn">TRUE</span>)[, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb5-19"><a href="#cb5-19"></a></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co"># Print table of parameter estimates</span></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="fu">kable</span>(param_bi_lcsm_01, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">label</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.lv</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">gamma_lx1</td>
<td style="text-align: right;">55.158</td>
<td style="text-align: right;">0.080</td>
<td style="text-align: right;">690.805</td>
<td style="text-align: left;">&lt; .001</td>
<td style="text-align: right;">17.878</td>
</tr>
<tr class="even">
<td style="text-align: left;">sigma2_lx1</td>
<td style="text-align: right;">9.519</td>
<td style="text-align: right;">0.669</td>
<td style="text-align: right;">14.221</td>
<td style="text-align: left;">&lt; .001</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sigma2_ux</td>
<td style="text-align: right;">3.575</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">5.542</td>
<td style="text-align: left;">&lt; .001</td>
<td style="text-align: right;">3.575</td>
</tr>
<tr class="even">
<td style="text-align: left;">alpha_g2</td>
<td style="text-align: right;">17.371</td>
<td style="text-align: right;">3.516</td>
<td style="text-align: right;">4.941</td>
<td style="text-align: left;">&lt; .001</td>
<td style="text-align: right;">17.337</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sigma2_g2</td>
<td style="text-align: right;">1.004</td>
<td style="text-align: right;">0.222</td>
<td style="text-align: right;">4.525</td>
<td style="text-align: left;">&lt; .001</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">sigma_g2lx1</td>
<td style="text-align: right;">2.261</td>
<td style="text-align: right;">0.709</td>
<td style="text-align: right;">3.186</td>
<td style="text-align: left;">.001</td>
<td style="text-align: right;">0.731</td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta_x</td>
<td style="text-align: right;">-0.272</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">-4.235</td>
<td style="text-align: left;">&lt; .001</td>
<td style="text-align: right;">-1.214</td>
</tr>
<tr class="even">
<td style="text-align: left;">phi_x</td>
<td style="text-align: right;">0.429</td>
<td style="text-align: right;">0.115</td>
<td style="text-align: right;">3.714</td>
<td style="text-align: left;">&lt; .001</td>
<td style="text-align: right;">0.371</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>The results of the latent change score model (LCSM) for height indicated increasing patterns of growth. The fitted model included a constant change factor of .52, reflecting a uniform base growth factor across all individuals consistently over time. The proportional change factor of -.27 illustrates a negative relationship, indicating that higher initial heights might result in lesser incremental growth. The phi estimate .43 shows autoregressive effects of the change scores, where the direction and magnitude of past growth significantly predict subsequent changes.</p>
</section>
<section id="model-plots" class="level3">
<h3 class="anchored" data-anchor-id="model-plots">Model Plots</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Path diagram plot of model results</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="fu">plot_lcsm</span>(</span>
<span id="cb6-3"><a href="#cb6-3"></a>    <span class="at">lavaan_object =</span> uni_lavaan_results,</span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="at">lavaan_syntax =</span> uni_lavaan_syntax,</span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="at">edge.label.cex =</span> .<span class="dv">9</span>,</span>
<span id="cb6-6"><a href="#cb6-6"></a>    <span class="at">lcsm_colours =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-7"><a href="#cb6-7"></a>    <span class="at">lcsm =</span> <span class="st">"univariate"</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_Examples_LatentChangeScoresModels_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This path diagram represents the structural relationships specified in the LCSM by simplifying the model structure into a more intuitive graphical format. The diagram highlights connections and dependencies among the variables, as well as the model’s estimated parameters.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Trajectory Plots</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_trajectories</span>(</span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="at">data =</span> df_wide,</span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="at">id_var =</span> <span class="st">"id"</span>,</span>
<span id="cb7-5"><a href="#cb7-5"></a>    <span class="at">var_list =</span> <span class="fu">c</span>(</span>
<span id="cb7-6"><a href="#cb7-6"></a>        <span class="st">"Height_Baseline"</span>,</span>
<span id="cb7-7"><a href="#cb7-7"></a>        <span class="st">"Height_Year_1"</span>,</span>
<span id="cb7-8"><a href="#cb7-8"></a>        <span class="st">"Height_Year_2"</span>,</span>
<span id="cb7-9"><a href="#cb7-9"></a>        <span class="st">"Height_Year_3"</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>    ),</span>
<span id="cb7-11"><a href="#cb7-11"></a>    <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"X Score"</span>,</span>
<span id="cb7-12"><a href="#cb7-12"></a>    <span class="at">connect_missing =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-13"><a href="#cb7-13"></a>    <span class="at">random_sample_frac =</span> <span class="fl">0.3</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>)</span>
<span id="cb7-15"><a href="#cb7-15"></a></span>
<span id="cb7-16"><a href="#cb7-16"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="9_Examples_LatentChangeScoresModels_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This trajectory plot depicts individual growth patterns based on a random sample of 30% of the data. The plot reveals individual variability in changes in height measurements among participants across 4 annual assessments, providing a visualization of how different individuals progress over time.</p>
</section>
</section>
<section id="wrapping-up" class="level2">
<h2 class="anchored" data-anchor-id="wrapping-up">Wrapping Up</h2>
<p>This analysis utilized a latent change score model (LCSM) to study the progression of participants’ height across multiple time points, controlling for baseline height measurements. Model results demonstrated a consistent growth pattern, with a constant change factor (γ = .52), which suggests a uniform growth rate across all individuals over time. The proportional change factor (β = -.27) indicated a negative relationship, revealing that individuals with greater initial heights experienced smaller incremental increases. Additionally, the autoregressive parameter (φ = 0.43) highlighted that previous growth trajectories significantly influence subsequent changes, providing insights into the dynamic nature of growth.</p>
<p>The LCSM offers a robust framework for analyzing longitudinal data, as it accounts for measurement errors and individual differences in baseline scores. This approach is particularly useful in developmental studies where understanding the intricacies of growth patterns is emphasized. This approach disentangles the elements of growth over time showing the predictive utility of earlier measurements and extending our understanding of growth dynamics.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/opendevsci\.github\.io\/LongDev-ABCD\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb8" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">---</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="an">title:</span><span class="co"> "Latent Change Score Models"</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="an">author:</span><span class="co"> "Biostatistics Working Group"</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">---</span></span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="in">```{r}</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#| echo: FALSE # The content of this code block will not be rendered</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#| output: FALSE # Output from this code block will not be rendered</span></span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co"># This code configures knitr code chunk options</span></span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb8-15"><a href="#cb8-15"></a>    <span class="at">echo =</span> T, <span class="at">message =</span> F, <span class="at">warning =</span> F, <span class="at">error =</span> F, <span class="at">output =</span> T,</span>
<span id="cb8-16"><a href="#cb8-16"></a>    <span class="at">comment =</span> <span class="cn">NA</span>, <span class="at">cache =</span> T, <span class="at">code_folding =</span> T,</span>
<span id="cb8-17"><a href="#cb8-17"></a>    <span class="at">R.options =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">220</span>, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="at">fig.align =</span> <span class="st">"center"</span>,</span>
<span id="cb8-19"><a href="#cb8-19"></a>    <span class="at">out.width =</span> <span class="st">"75%"</span>, <span class="at">fig.asp =</span> .<span class="dv">75</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>)</span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="in">```</span></span>
<span id="cb8-22"><a href="#cb8-22"></a></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="in">```{r}</span></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co">#| echo: FALSE # The content of this code block will not be shown when rendered</span></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co">#| output: FALSE # Output from this code block will not be shown when rendered</span></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co">#| cache: FALSE</span></span>
<span id="cb8-29"><a href="#cb8-29"></a></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co"># This code loads the data to be used for the example</span></span>
<span id="cb8-31"><a href="#cb8-31"></a></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb8-33"><a href="#cb8-33"></a></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="co"># Set the data path</span></span>
<span id="cb8-35"><a href="#cb8-35"></a>data_path <span class="ot">&lt;-</span> <span class="st">"/Users/shawes/ABCD/data/rds/abcd_5.0_rds/core-rds-5.0/non-imaging_excluding_nt_5.0.rds"</span></span>
<span id="cb8-36"><a href="#cb8-36"></a></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="co"># Read the data</span></span>
<span id="cb8-38"><a href="#cb8-38"></a>df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(data_path)</span>
<span id="cb8-39"><a href="#cb8-39"></a></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="co"># Create and mutate the dataframe</span></span>
<span id="cb8-41"><a href="#cb8-41"></a>df_long <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb8-42"><a href="#cb8-42"></a>    <span class="fu">select</span>(src_subject_id, eventname, anthroheightcalc) <span class="sc">%&gt;%</span></span>
<span id="cb8-43"><a href="#cb8-43"></a>    <span class="fu">filter</span>(eventname <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"baseline_year_1_arm_1"</span>, <span class="st">"1_year_follow_up_y_arm_1"</span>, <span class="st">"2_year_follow_up_y_arm_1"</span>, <span class="st">"3_year_follow_up_y_arm_1"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-44"><a href="#cb8-44"></a>    <span class="fu">drop_na</span>(anthroheightcalc) <span class="sc">%&gt;%</span></span>
<span id="cb8-45"><a href="#cb8-45"></a>    <span class="fu">arrange</span>(src_subject_id, eventname) <span class="sc">%&gt;%</span></span>
<span id="cb8-46"><a href="#cb8-46"></a>    <span class="fu">mutate</span>(</span>
<span id="cb8-47"><a href="#cb8-47"></a>        <span class="at">src_subject_id =</span> <span class="fu">factor</span>(src_subject_id),</span>
<span id="cb8-48"><a href="#cb8-48"></a>        <span class="at">eventname =</span> <span class="fu">factor</span>(eventname, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"baseline_year_1_arm_1"</span>, <span class="st">"1_year_follow_up_y_arm_1"</span>, <span class="st">"2_year_follow_up_y_arm_1"</span>, <span class="st">"3_year_follow_up_y_arm_1"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Baseline"</span>, <span class="st">"Year_1"</span>, <span class="st">"Year_2"</span>, <span class="st">"Year_3"</span>)),</span>
<span id="cb8-49"><a href="#cb8-49"></a>        <span class="at">anthroheightcalc =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(anthroheightcalc), <span class="dv">2</span>)</span>
<span id="cb8-50"><a href="#cb8-50"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb8-51"><a href="#cb8-51"></a>    <span class="fu">rename</span>(</span>
<span id="cb8-52"><a href="#cb8-52"></a>        <span class="at">id =</span> src_subject_id,</span>
<span id="cb8-53"><a href="#cb8-53"></a>        <span class="at">event =</span> eventname,</span>
<span id="cb8-54"><a href="#cb8-54"></a>        <span class="at">height =</span> anthroheightcalc</span>
<span id="cb8-55"><a href="#cb8-55"></a>    )</span>
<span id="cb8-56"><a href="#cb8-56"></a></span>
<span id="cb8-57"><a href="#cb8-57"></a>df_long <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb8-58"><a href="#cb8-58"></a>    <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb8-59"><a href="#cb8-59"></a>    <span class="fu">filter</span>(<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"Baseline"</span>, <span class="st">"Year_1"</span>, <span class="st">"Year_2"</span>, <span class="st">"Year_3"</span>) <span class="sc">%in%</span> event)) <span class="sc">%&gt;%</span></span>
<span id="cb8-60"><a href="#cb8-60"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb8-61"><a href="#cb8-61"></a></span>
<span id="cb8-62"><a href="#cb8-62"></a><span class="in">```</span></span>
<span id="cb8-63"><a href="#cb8-63"></a></span>
<span id="cb8-64"><a href="#cb8-64"></a><span class="fu">## Overview</span></span>
<span id="cb8-65"><a href="#cb8-65"></a>Latent change score models are a statistical technique used for analyzing changes over time by integrating aspects of both structural equation modeling and traditional change score methods. This approach constructs latent variables that directly represent change between time points. First, latent variables for each time point are modeled to capture the true score of the variable of interest, adjusting for measurement error. Then, latent change scores are defined as the difference between latent variables across consecutive time points.</span>
<span id="cb8-66"><a href="#cb8-66"></a></span>
<span id="cb8-67"><a href="#cb8-67"></a>This example will explore changes in height from baseline to 3 subsequent annual follow-ups in a sample of participants from the ABCD Study. Initially, latent variables for height at each time point are defined to account for measurement error and capture the true height scores. Latent change scores are then calculated between each pair of consecutive time points to model the true change in height. The dynamics of these changes are visually depicted using trajectory plots, providing a clear visual representation of growth patterns across participants the study.</span>
<span id="cb8-68"><a href="#cb8-68"></a></span>
<span id="cb8-69"><a href="#cb8-69"></a><span class="fu">## Preliminary Setup</span></span>
<span id="cb8-70"><a href="#cb8-70"></a><span class="fu">### Load Packages</span></span>
<span id="cb8-73"><a href="#cb8-73"></a><span class="in">```{r}</span></span>
<span id="cb8-74"><a href="#cb8-74"></a><span class="fu">library</span>(tidyverse) <span class="co"># Collection of R packages for data science</span></span>
<span id="cb8-75"><a href="#cb8-75"></a><span class="fu">library</span>(gtsummary) <span class="co"># Publication-ready tables</span></span>
<span id="cb8-76"><a href="#cb8-76"></a><span class="fu">library</span>(rstatix) <span class="co"># Statistical Tests in tidy format</span></span>
<span id="cb8-77"><a href="#cb8-77"></a><span class="fu">library</span>(lme4) <span class="co"># Linear mixed-effects models</span></span>
<span id="cb8-78"><a href="#cb8-78"></a><span class="fu">library</span>(lcsm) <span class="co"># Latent Change Score Models</span></span>
<span id="cb8-79"><a href="#cb8-79"></a><span class="fu">library</span>(lavaan) <span class="co"># Structural Equation Modeling</span></span>
<span id="cb8-80"><a href="#cb8-80"></a><span class="fu">library</span>(kableExtra) <span class="co"># Table formatting</span></span>
<span id="cb8-81"><a href="#cb8-81"></a><span class="in">```</span></span>
<span id="cb8-82"><a href="#cb8-82"></a></span>
<span id="cb8-83"><a href="#cb8-83"></a><span class="fu">### Descriptives</span></span>
<span id="cb8-86"><a href="#cb8-86"></a><span class="in">```{r}</span></span>
<span id="cb8-87"><a href="#cb8-87"></a>descriptives_table <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb8-88"><a href="#cb8-88"></a>    <span class="fu">select</span>(event, height) <span class="sc">%&gt;%</span></span>
<span id="cb8-89"><a href="#cb8-89"></a>    <span class="fu">mutate</span>(<span class="at">event =</span> <span class="fu">factor</span>(event)) <span class="sc">%&gt;%</span></span>
<span id="cb8-90"><a href="#cb8-90"></a>    <span class="fu">tbl_summary</span>(</span>
<span id="cb8-91"><a href="#cb8-91"></a>        <span class="at">by =</span> event,</span>
<span id="cb8-92"><a href="#cb8-92"></a>        <span class="at">missing =</span> <span class="st">"no"</span>,</span>
<span id="cb8-93"><a href="#cb8-93"></a>        <span class="at">label =</span> <span class="fu">list</span>(height <span class="sc">~</span> <span class="st">"Height"</span>),</span>
<span id="cb8-94"><a href="#cb8-94"></a>        <span class="at">statistic =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd}) )"</span>, <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"{p}%"</span>),</span>
<span id="cb8-95"><a href="#cb8-95"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb8-96"><a href="#cb8-96"></a>    <span class="fu">modify_header</span>(<span class="fu">all_stat_cols</span>() <span class="sc">~</span> <span class="st">"**{level}**&lt;br&gt;N = {n}"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-97"><a href="#cb8-97"></a>    <span class="fu">bold_labels</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-98"><a href="#cb8-98"></a>    <span class="fu">italicize_levels</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-99"><a href="#cb8-99"></a>    <span class="fu">modify_spanning_header</span>(<span class="fu">all_stat_cols</span>() <span class="sc">~</span> <span class="st">"**Assessment Wave**"</span>)</span>
<span id="cb8-100"><a href="#cb8-100"></a><span class="fu">theme_gtsummary_compact</span>()</span>
<span id="cb8-101"><a href="#cb8-101"></a></span>
<span id="cb8-102"><a href="#cb8-102"></a>descriptives_table</span>
<span id="cb8-103"><a href="#cb8-103"></a></span>
<span id="cb8-104"><a href="#cb8-104"></a><span class="in">```</span></span>
<span id="cb8-105"><a href="#cb8-105"></a></span>
<span id="cb8-106"><a href="#cb8-106"></a><span class="fu">## Results </span></span>
<span id="cb8-107"><a href="#cb8-107"></a><span class="fu">### Compute Latent Change Score Model</span></span>
<span id="cb8-108"><a href="#cb8-108"></a>The code below is used to compute a latent change score analysis to investigate changes in height across four annual assessments. This statistical approach models growth factors, including constant and proportional changes, and how they vary between individuals. It also evaluates the stability of growth patterns over time, giving a more nuanced understanding of developmental trajectories and the amount of change between each time point.</span>
<span id="cb8-111"><a href="#cb8-111"></a><span class="in">```{r}</span></span>
<span id="cb8-112"><a href="#cb8-112"></a><span class="co"># Reshape data from long to wide format</span></span>
<span id="cb8-113"><a href="#cb8-113"></a>df_wide <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb8-114"><a href="#cb8-114"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb8-115"><a href="#cb8-115"></a>        <span class="at">id_cols =</span> <span class="fu">c</span>(id),</span>
<span id="cb8-116"><a href="#cb8-116"></a>        <span class="at">names_from =</span> event,</span>
<span id="cb8-117"><a href="#cb8-117"></a>        <span class="at">values_from =</span> height,</span>
<span id="cb8-118"><a href="#cb8-118"></a>        <span class="at">names_prefix =</span> <span class="st">"Height_"</span></span>
<span id="cb8-119"><a href="#cb8-119"></a>    )</span>
<span id="cb8-120"><a href="#cb8-120"></a></span>
<span id="cb8-121"><a href="#cb8-121"></a>df_wide <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(df_wide)</span>
<span id="cb8-122"><a href="#cb8-122"></a></span>
<span id="cb8-123"><a href="#cb8-123"></a><span class="co"># Fit lcsm and save the results</span></span>
<span id="cb8-124"><a href="#cb8-124"></a>uni_lavaan_results <span class="ot">&lt;-</span> <span class="fu">fit_uni_lcsm</span>(</span>
<span id="cb8-125"><a href="#cb8-125"></a>    <span class="at">data =</span> df_wide,</span>
<span id="cb8-126"><a href="#cb8-126"></a>    <span class="at">var =</span> <span class="fu">c</span>(</span>
<span id="cb8-127"><a href="#cb8-127"></a>        <span class="st">"Height_Baseline"</span>, <span class="st">"Height_Year_1"</span>,</span>
<span id="cb8-128"><a href="#cb8-128"></a>        <span class="st">"Height_Year_2"</span>, <span class="st">"Height_Year_3"</span></span>
<span id="cb8-129"><a href="#cb8-129"></a>    ),</span>
<span id="cb8-130"><a href="#cb8-130"></a>    <span class="at">model =</span> <span class="fu">list</span>(</span>
<span id="cb8-131"><a href="#cb8-131"></a>        <span class="at">alpha_constant =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-132"><a href="#cb8-132"></a>        <span class="at">beta =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-133"><a href="#cb8-133"></a>        <span class="at">phi =</span> <span class="cn">TRUE</span></span>
<span id="cb8-134"><a href="#cb8-134"></a>    )</span>
<span id="cb8-135"><a href="#cb8-135"></a>)</span>
<span id="cb8-136"><a href="#cb8-136"></a></span>
<span id="cb8-137"><a href="#cb8-137"></a>uni_lavaan_results</span>
<span id="cb8-138"><a href="#cb8-138"></a></span>
<span id="cb8-139"><a href="#cb8-139"></a><span class="co"># Save the lavaan syntax that is used to create the layout matrix for semPlot</span></span>
<span id="cb8-140"><a href="#cb8-140"></a>uni_lavaan_syntax <span class="ot">&lt;-</span> <span class="fu">fit_uni_lcsm</span>(</span>
<span id="cb8-141"><a href="#cb8-141"></a>    <span class="at">data =</span> df_wide,</span>
<span id="cb8-142"><a href="#cb8-142"></a>    <span class="at">var =</span> <span class="fu">c</span>(</span>
<span id="cb8-143"><a href="#cb8-143"></a>        <span class="st">"Height_Baseline"</span>, <span class="st">"Height_Year_1"</span>,</span>
<span id="cb8-144"><a href="#cb8-144"></a>        <span class="st">"Height_Year_2"</span>, <span class="st">"Height_Year_3"</span></span>
<span id="cb8-145"><a href="#cb8-145"></a>    ),</span>
<span id="cb8-146"><a href="#cb8-146"></a>    <span class="at">model =</span> <span class="fu">list</span>(</span>
<span id="cb8-147"><a href="#cb8-147"></a>        <span class="at">alpha_constant =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-148"><a href="#cb8-148"></a>        <span class="at">beta =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-149"><a href="#cb8-149"></a>        <span class="at">phi =</span> <span class="cn">TRUE</span></span>
<span id="cb8-150"><a href="#cb8-150"></a>    ),</span>
<span id="cb8-151"><a href="#cb8-151"></a>    <span class="at">return_lavaan_syntax =</span> <span class="cn">TRUE</span></span>
<span id="cb8-152"><a href="#cb8-152"></a>)</span>
<span id="cb8-153"><a href="#cb8-153"></a></span>
<span id="cb8-154"><a href="#cb8-154"></a><span class="co"># Now extract parameter estimates</span></span>
<span id="cb8-155"><a href="#cb8-155"></a><span class="co"># Only extract first 7 columns for this example by adding [ , 1:7]</span></span>
<span id="cb8-156"><a href="#cb8-156"></a>param_bi_lcsm_01 <span class="ot">&lt;-</span> <span class="fu">extract_param</span>(uni_lavaan_results, <span class="at">printp =</span> <span class="cn">TRUE</span>)[, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb8-157"><a href="#cb8-157"></a></span>
<span id="cb8-158"><a href="#cb8-158"></a><span class="co"># Print table of parameter estimates</span></span>
<span id="cb8-159"><a href="#cb8-159"></a><span class="fu">kable</span>(param_bi_lcsm_01, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb8-160"><a href="#cb8-160"></a></span>
<span id="cb8-161"><a href="#cb8-161"></a><span class="in">```</span></span>
<span id="cb8-162"><a href="#cb8-162"></a></span>
<span id="cb8-163"><a href="#cb8-163"></a>The results of the latent change score model (LCSM) for height indicated increasing patterns of growth. The fitted model included a constant change factor of .52, reflecting a uniform base growth factor across all individuals consistently over time. The proportional change factor of -.27 illustrates a negative relationship, indicating that higher initial heights might result in lesser incremental growth. The phi estimate .43 shows autoregressive effects of the change scores, where the direction and magnitude of past growth significantly predict subsequent changes. </span>
<span id="cb8-164"><a href="#cb8-164"></a></span>
<span id="cb8-165"><a href="#cb8-165"></a><span class="fu">### Model Plots</span></span>
<span id="cb8-168"><a href="#cb8-168"></a><span class="in">```{r}</span></span>
<span id="cb8-169"><a href="#cb8-169"></a><span class="co"># Path diagram plot of model results</span></span>
<span id="cb8-170"><a href="#cb8-170"></a><span class="fu">plot_lcsm</span>(</span>
<span id="cb8-171"><a href="#cb8-171"></a>    <span class="at">lavaan_object =</span> uni_lavaan_results,</span>
<span id="cb8-172"><a href="#cb8-172"></a>    <span class="at">lavaan_syntax =</span> uni_lavaan_syntax,</span>
<span id="cb8-173"><a href="#cb8-173"></a>    <span class="at">edge.label.cex =</span> .<span class="dv">9</span>,</span>
<span id="cb8-174"><a href="#cb8-174"></a>    <span class="at">lcsm_colours =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-175"><a href="#cb8-175"></a>    <span class="at">lcsm =</span> <span class="st">"univariate"</span></span>
<span id="cb8-176"><a href="#cb8-176"></a>)</span>
<span id="cb8-177"><a href="#cb8-177"></a></span>
<span id="cb8-178"><a href="#cb8-178"></a><span class="in">```</span></span>
<span id="cb8-179"><a href="#cb8-179"></a></span>
<span id="cb8-180"><a href="#cb8-180"></a>This path diagram represents the structural relationships specified in the LCSM by simplifying the model structure into a more intuitive graphical format. The diagram highlights connections and dependencies among the variables, as well as the model's estimated parameters.</span>
<span id="cb8-183"><a href="#cb8-183"></a><span class="in">```{r}</span></span>
<span id="cb8-184"><a href="#cb8-184"></a><span class="co"># Trajectory Plots</span></span>
<span id="cb8-185"><a href="#cb8-185"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_trajectories</span>(</span>
<span id="cb8-186"><a href="#cb8-186"></a>    <span class="at">data =</span> df_wide,</span>
<span id="cb8-187"><a href="#cb8-187"></a>    <span class="at">id_var =</span> <span class="st">"id"</span>,</span>
<span id="cb8-188"><a href="#cb8-188"></a>    <span class="at">var_list =</span> <span class="fu">c</span>(</span>
<span id="cb8-189"><a href="#cb8-189"></a>        <span class="st">"Height_Baseline"</span>,</span>
<span id="cb8-190"><a href="#cb8-190"></a>        <span class="st">"Height_Year_1"</span>,</span>
<span id="cb8-191"><a href="#cb8-191"></a>        <span class="st">"Height_Year_2"</span>,</span>
<span id="cb8-192"><a href="#cb8-192"></a>        <span class="st">"Height_Year_3"</span></span>
<span id="cb8-193"><a href="#cb8-193"></a>    ),</span>
<span id="cb8-194"><a href="#cb8-194"></a>    <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"X Score"</span>,</span>
<span id="cb8-195"><a href="#cb8-195"></a>    <span class="at">connect_missing =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-196"><a href="#cb8-196"></a>    <span class="at">random_sample_frac =</span> <span class="fl">0.3</span></span>
<span id="cb8-197"><a href="#cb8-197"></a>)</span>
<span id="cb8-198"><a href="#cb8-198"></a></span>
<span id="cb8-199"><a href="#cb8-199"></a>plot</span>
<span id="cb8-200"><a href="#cb8-200"></a><span class="in">```</span></span>
<span id="cb8-201"><a href="#cb8-201"></a></span>
<span id="cb8-202"><a href="#cb8-202"></a>This trajectory plot depicts individual growth patterns based on a random sample of 30% of the data. The plot reveals individual variability in changes in height measurements among participants across 4 annual assessments, providing a visualization of how different individuals progress over time. </span>
<span id="cb8-203"><a href="#cb8-203"></a></span>
<span id="cb8-204"><a href="#cb8-204"></a><span class="fu">## Wrapping Up</span></span>
<span id="cb8-205"><a href="#cb8-205"></a></span>
<span id="cb8-206"><a href="#cb8-206"></a>This analysis utilized a latent change score model (LCSM) to study the progression of participants' height across multiple time points, controlling for baseline height measurements. Model results demonstrated a consistent growth pattern, with a constant change factor (γ = .52), which suggests a uniform growth rate across all individuals over time. The proportional change factor (β = -.27) indicated a negative relationship, revealing that individuals with greater initial heights experienced smaller incremental increases. Additionally, the autoregressive parameter (φ = 0.43) highlighted that previous growth trajectories significantly influence subsequent changes, providing insights into the dynamic nature of growth.</span>
<span id="cb8-207"><a href="#cb8-207"></a></span>
<span id="cb8-208"><a href="#cb8-208"></a>The LCSM offers a robust framework for analyzing longitudinal data, as it accounts for measurement errors and individual differences in baseline scores. This approach is particularly useful in developmental studies where understanding the intricacies of growth patterns is emphasized. This approach disentangles the elements of growth over time showing the predictive utility of earlier measurements and extending our understanding of growth dynamics.</span>
<span id="cb8-209"><a href="#cb8-209"></a></span>
<span id="cb8-210"><a href="#cb8-210"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>